# Development Dockerfile with Air hot reload
FROM golang:1.25-alpine

WORKDIR /app

# Install air for hot reload
RUN go install github.com/air-verse/air@latest

# Install dependencies for CGO (if needed)
RUN apk add --no-cache gcc musl-dev

# Copy go workspace files
COPY go.work go.work.sum ./

# Copy all module directories
COPY pkg/ pkg/
COPY backend-api-gateway/ backend-api-gateway/
COPY backend-auth/ backend-auth/
COPY backend-ticket/ backend-ticket/
COPY backend-booking/ backend-booking/
COPY backend-payment/ backend-payment/
COPY scripts/ scripts/
COPY tests/ tests/

# Download dependencies
RUN go work sync

# Default command (overridden by docker-compose)
CMD ["air"]
